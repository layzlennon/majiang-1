// Generated by CoffeeScript 1.12.5

var HTTP, URL;

URL = "http://localhost:9000";

cc.VERSION = "20161227";

HTTP = cc.Class({
    "extends": cc.Component,
    statics: {
        sessionId: 0,
        userId: 0,
        master_url: URL,
        url: URL,
        sendRequest: function(path, data, handler, extraUrl) {
            var key, requestURL, str, value, xhr;
            if (extraUrl == null) {
                extraUrl = null;
            }
            xhr = cc.loader.getXMLHttpRequest();
            xhr.timeout = 5000;
            str = "?";
            if (data) {
                cc.log("data :" + JSON.stringify(data));
                for (key in data) {
                    value = data[key];
                    if (str !== '?') {
                        str += "&";
                    }
                    str += key + "=" + value;
                }
            }
            if (extraUrl === null) {
                extraUrl = HTTP.url;
            }
            requestURL = extraUrl + path + encodeURI(str);
            cc.log("extraUrl :" + extraUrl);
            cc.log("cc.URL:" + URL);
            cc.log("RequestURL:" + requestURL);
            xhr.open("GET", requestURL, true);
            if (cc.sys.isNative) {
                xhr.setRequestHeader("Accept-Encoding", "gzip,deflate", "text/html;charset=UTF-8");
            }
            xhr.onreadystatechange = function() {
                var e, ret;
                if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {
                    xhr.responseText;
                    try {
                        ret = JSON.parse(xhr.responseText);
                        if (handler !== null) {
                            return handler(ret);
                        }
                    } catch (error) {
                        e = error;
                        return cc.log("err:" + e);
                    } finally {

                    }
                }
            };
            xhr.send();
            return xhr;
        }
    }
});


//# sourceMappingURL=HTTP.js.map
